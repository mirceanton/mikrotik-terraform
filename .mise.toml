[tools]
# Terraform Stuff
"aqua:hashicorp/terraform" = "1.11.4"
"qua:dineshba/tf-summarize" = "0.3.14"

# Miscellaneous Tools
"aqua:FiloSottile/age" = "1.2.1"
"aqua:getsops/sops" = "3.10.2"
"aqua:rhysd/actionlint" = "1.7.7"
node = "22"
"npm:@commitlint/cli" = "19.8.0"
"npm:renovate" = "40.3.4"


# =================================================================================================
# TASKS
# =================================================================================================
[tasks.decrypt]
description = "Decrypt the terraform state and vars files."
run = [
    "sops --decrypt terraform.tfstate.sops > terraform.tfstate",
    "sops --decrypt credentials.auto.tfvars.sops > credentials.auto.tfvars"
]

[tasks.encrypt]
description = "Encrypt the terraform state and vars files."
run = [
    "sops --encrypt terraform.tfstate > terraform.tfstate.sops",
    "sops --encrypt credentials.auto.tfvars > credentials.auto.tfvars.sops"
]

[tasks.plan]
description = "Run and summarize terraform plan"
dir = ""
run = "terraform plan -out=tfplan && tf-summarize tfplan && rm tfplan"